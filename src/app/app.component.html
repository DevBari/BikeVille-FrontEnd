<app-navbar 
  [cartCount]="cartCount" 
  (toggleCartEvent)="toggleCart()"
  (routeChanged)="onRouteChange($event)">
</app-navbar>

<app-header *ngIf="currentRoute === 'home' || currentRoute === 'home#home'"></app-header>

<!-- Route outlet for dynamic content -->
<router-outlet></router-outlet>

  <!-- Finestra del Carrello - Spostato fuori dal router-outlet -->
  <div class="cart-overlay" [class.open]="isCartOpen">

    <div class="overlay-background" (click)="toggleCart()"></div>

    <div class="cart-container">

      <button class="close-button" (click)="toggleCart()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512" width="20" height="20">
          <path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.19 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.19 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"/>
        </svg>
      </button>

      <!-- Contenuto del carrello -->
      <h2 style="font-family: 'inter-bold';">Il tuo Carrello üõí</h2>
  
      <ng-container *ngIf="cartItems.length > 0; else emptyCart">

        <ul class="cart-items">
  
          <li *ngFor="let item of cartItems">
  
            <img [src]="item.product.imageUrl || 'https://it.fiido.com/cdn/shop/files/x.png?v=1703580201&width=450'"
              alt="{{ item.product.name }}" class="cart-item-image">
  
            <div class="cart-item-details">
  
              <h3>{{ item.product.name }}</h3>
              <p>Prezzo: {{ item.product.listPrice | currency }}</p>
  
              <div class="quantity-control">
  
                <button (click)="updateQuantity(item.product.productId!, item.quantity - 1)"
                  [disabled]="item.quantity <= 1">-</button>
  
                <span>{{ item.quantity }}</span>
  
                <button (click)="updateQuantity(item.product.productId!, item.quantity + 1)">+</button>
  
              </div>
  
              <button class="remove-button" (click)="removeItem(item.product.productId!)">
  
                <svg viewBox="0 0 448 512" class="svgIcon">
  
                  <path
                    d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z">
                  </path>
  
                </svg>
  
              </button>
  
            </div>
  
          </li>
  
        </ul>

        <p class="total-price">Totale: {{ calculateTotal() | currency }} üßæ</p>
        <button class="clear-cart" (click)="clearCart()">Svuota Carrello</button>

      </ng-container>
  
      <ng-template #emptyCart>

        <div class="empty-cart-message">
          <p>Nessun articolo nel carrello ‚ùå</p>
        </div>

      </ng-template>

    </div>

  </div>

<!-- footer component here -->
<app-footer *ngIf="ShowFooter()"></app-footer>